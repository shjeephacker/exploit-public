#include <stdlib.h>
#include <unistd.h>
#include <stdio.h>
#include <string.h>
 
unsigned long int main_addr;

void get_shell()
{
  char *argv[] = {"/bin/sh", NULL};

  execve("/bin/sh", argv, NULL);
}

#define OFFSET (8 * 3)
void getpath()
{
  char buffer[64];
  unsigned long int addr;
   
  /*
  printf("input path please: \n");
  fflush(stdout);
  gets(buffer);
  */
   
 // memset(buffer, 'A', sizeof(buffer) + OFFSET);
  void **get_offset = buffer + sizeof(buffer) + OFFSET;
  (*get_offset) = get_shell;

}
 
int main(int argc, char **argv)
{
  main_addr =  (long unsigned int)__builtin_return_address(0);
  printf("\e[36m[+]main addr=0x%016lX\e[0m\n", main_addr);
  getpath();
  return 0;
}
